<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <title>Dashboard</title>
    <link rel="stylesheet" href="./css/site.css" />
  </head>
  <body>
    <div class="header">
      <div class="toggle">
        <a id="toggle-nav"><i class="fa fa-navicon cog"></i></a>
      </div>
    </div>
    <div class="container">
      <div class="sidebar" id="sidebar">
        <a href="dashboard.html"><i class="fa fa-home"></i> Dashboard</a>
        <a href="form.html"><i class="fa fa-shopping-cart"></i> Forms</a>
        <a href="tables.html"><i class="fa fa-shopping-bag"></i> Tables</a>
      </div>
      <div class="content">
        <div class="summary-container">
          <div class="summary">
            <div class="summary-icon"><i class="fa fa-users"></i></div>
            <div class="summary-content">
              <div class="summary-heading">Users</div>
              <div><h2>0</h2></div>
            </div>
          </div>
          <div class="summary">
            <div class="summary-icon"><i class="fa fa-signal"></i></div>
            <div class="summary-content">
              <div class="summary-heading">Products</div>
              <div><h2>0</h2></div>
            </div>
          </div>
          <div class="summary">
            <div class="summary-icon"><i class="fa fa-shopping-cart"></i></div>
            <div class="summary-content">
              <div class="summary-heading">Sales</div>
              <div><h2>0</h2></div>
            </div>
          </div>
          <div class="summary">
            <div class="summary-icon"><i class="fa fa-line-chart"></i></div>
            <div class="summary-content">
              <div class="summary-heading">Profit</div>
              <div><h2>0</h2></div>
            </div>
          </div>
        </div>
        <div class="charts-container">
          <!-- This is the chart content section-->
          <h4>Implement here..</h4>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $("document").ready(() => {
        // Your js here
        $("#toggle-nav").click(()=>{
          $(".sidebar").toggle(500);
        })
      });

      async function gateData(url) {
          const response = await  fetch('http://localhost:3000/statistics');
          if(response.ok){
            return response.json();
          }else{
            throw new error("falled to fetch the data");
          }
      }gateData('http://localhost:3000/statistics')
      .then(data =>{
        const users =document.getElementById("users");
        users.innerText =`${data.users}`;
        
        const products =document.getElementById("products");
        products.innerText =`${data.products}`;

        const sales =document.getElementById("sales");
        sales.innerText =`${data.sales}`;

        const profit =document.getElementById("profit");
        profit.innerText =`${data.profit}`;
      })
      .then(error=>{
        console.log(error)
      })


      // charts.js
      fetch('http://localhost:3000/visitors')
      .then(response => response.json())
      .then(data =>{
        const line = document.getElementById("line").getContext('2d');
        new Chart(line,{
          type:"line",
          data:{
            labels:data.day,
            datasets:[{
              labels:'vistors',
              data:data.count
            }]
          }
        })
      })

       fetch('http://localhost:3000/top_products')
      .then(response => response.json())
      .then(data =>{
        const bar = document.getElementById("bar").getContext('2d');
        new Chart(bar,{
          type:"bar",
          data:{
            labels:data.product,
            datasets:[{
              labels:'top_products',
              data:data.count
            }]
          }
        })
      })


       fetch('http://localhost:3000/sales')
      .then(response => response.json())
      .then(data =>{
        const scatter = document.getElementById("scatter").getContext('2d');
        new Chart(scatter,{
          type:"scatter",
          data:{
            datasets:[{
              labels:'sales',
              data:[
                  { x: 50, y: 7 },
                  { x: 60, y: 8 },
                  { x: 70, y: 8 },
                  { x: 80, y: 9 },
                  { x: 90, y: 9 },
                  { x: 100, y: 9 },
                  { x: 110, y: 10 },
                  { x: 120, y: 11 },
                  { x: 130, y: 14 },
                  { x: 140, y: 14 },
                  { x: 150, y: 15 },
              ]
            }]
          }
        })
      })

       fetch('http://localhost:3000/sold_products')
      .then(response => response.json())
      .then(data =>{
        const piechart = document.getElementById("piechart").getContext('2d');
        new Chart(piechart,{
          type:"pie",
          data:{
            labels:data.category,
            datasets:[{
              labels:'sold_products',
              data:data.count
            }]
          }
        })
      })

    </script>
  </body>
</html>
